<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡å­¦åˆ›ä½œ - å†™ä½œä¸­å¿ƒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        /* é€€å‡ºæŒ‰é’®æ ·å¼ */
        .logout-btn {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 10px 20px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            z-index: 9999;
            transition: background-color 0.3s ease;
        }
        
        .logout-btn:hover {
            background-color: #c0392b;
        }

        html {
            scroll-behavior: smooth;
        }

        /* å¯è°ƒæ•´çš„å¯¼èˆªæ é«˜åº¦ */
        :root {
            --nav-height: 80px; /* ä¿®æ”¹æ­¤å€¼ä»¥è°ƒæ•´å¯¼èˆªæ é«˜åº¦ */
            --primary-color: #4caf50;
            --primary-dark: #388e3c;
            --secondary-color: #f1f8e9;
            --text-color: #2c3e50;
            --text-light: #5b6b80;
            --border-color: #e0e0e0;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* å¯¼èˆªæ æ ·å¼ */
        .navbar {
            background-color: #141414;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: var(--nav-height);
            padding: 0 0; /* æ°´å¹³å†…è¾¹è·ç”± .container æ§åˆ¶ */
        }
        
        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .logo-icon {
            margin-right: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            position: absolute;
            left: 150px; /* è·ç¦»å·¦ä¾§50px */
        }

        .logo-icon img {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: contain;
        }
        
        .brand-name {
            color: #ffffff; /* ç»¿è‰² */
            font-size: 30px;
            font-family: 'ZiHun86', "Microsoft YaHei", sans-serif;/* å­—ä½“ */
            text-decoration: none;
            position: absolute;
            left: 210px; /* è·ç¦»å·¦ä¾§50px */
            font-weight: 500;
        }

        /* å³ä¾§å¯¼èˆªæ•´ä½“å‘å³åç§» 150pxï¼ˆæ¡Œé¢ï¼‰ */
        .nav-menu {
            display: flex;
            list-style: none;
            position: absolute;
            right: 150px; /* è·ç¦»å³ä¾§ 150px */
            top: 50%;
            transform: translateY(-50%);
        }
        
        .nav-item {
            margin-left: 30px;
        }
        
        .nav-link {
            text-decoration: none;
            color: #b1b1b1;
            font-weight: 500;
            font-size: 16px;
            transition: color 0.3s ease;
            position: relative;
            padding: 5px 0;
            font-weight: normal;
        }
        
        .nav-link:hover {
            color: #ffffff;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #3498db;
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .nav-link.active {
            color: #3498db;
        }
        
        .nav-link.active::after {
            width: 100%;
        }

        /* å†™ä½œä¸­å¿ƒå®¹å™¨ */
        .writing-center {
            max-width: 1000px;
            margin: 40px auto;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page-header {
            padding: 30px 40px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, #ffffff 100%);
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }

        .page-title {
            font-size: 32px;
            color: var(--text-color);
            margin-bottom: 10px;
            font-weight: 500;
        }

        .page-subtitle {
            font-size: 16px;
            color: var(--text-light);
        }

        /* åˆ›ä½œç±»å‹é€‰æ‹© */
        .creation-type-selector {
            padding: 30px 40px;
            border-bottom: 1px solid var(--border-color);
        }

        .selector-title {
            font-size: 20px;
            color: var(--text-color);
            margin-bottom: 20px;
            font-weight: 500;
        }

        .type-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .type-tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: 2px solid transparent;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-light);
        }

        .type-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-dark);
        }

        .type-tab:hover:not(.active) {
            background: var(--secondary-color);
            border-color: var(--primary-color);
        }

        /* åˆ›ä½œè¡¨å• */
        .creation-form {
            padding: 30px 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
            font-size: 16px;
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: #ffffff;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }

        .form-textarea {
            min-height: 300px;
            resize: vertical;
            font-family: inherit;
            line-height: 1.6;
        }

        /* ç‰¹å®šåˆ›ä½œç±»å‹çš„è¡¨å•æ ·å¼ */
        .type-form {
            display: none;
        }

        .type-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æç¤ºæ–‡å­— */
        .form-hint {
            font-size: 14px;
            color: var(--text-light);
            margin-top: 5px;
            font-style: italic;
        }

        /* æ“ä½œæŒ‰é’® */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .btn-icon {
            margin-right: 8px;
        }

        /* ä¿å­˜æˆåŠŸæç¤º */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px 20px;
            border-radius: 6px;
            border: 1px solid #c3e6cb;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* é¢„è§ˆåŒºåŸŸ */
        .preview-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid var(--border-color);
        }

        .preview-title {
            font-size: 20px;
            color: var(--text-color);
            margin-bottom: 20px;
            font-weight: 500;
        }

        .preview-container {
            background: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 20px;
            min-height: 200px;
            transition: all 0.3s ease;
        }

        .preview-container.empty {
            color: var(--text-light);
            font-style: italic;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* åº•éƒ¨å¯¼èˆª */
        .bottom-nav {
            padding: 30px 40px;
            background: #f8f9fa;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .nav-info {
            color: var(--text-light);
            font-size: 14px;
        }

        /* ä½œå“åˆ—è¡¨ */
        .works-list {
            margin-top: 30px;
        }

        .works-title {
            font-size: 18px;
            color: var(--text-color);
            margin-bottom: 15px;
            font-weight: 500;
        }

        .work-item {
            background: #f8f9fa;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .work-item:hover {
            background: var(--secondary-color);
            transform: translateX(5px);
        }

        .work-info {
            flex: 1;
        }

        .work-name {
            font-weight: 500;
            color: var(--text-color);
            margin-bottom: 5px;
        }

        .work-meta {
            font-size: 14px;
            color: var(--text-light);
        }

        .work-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 5px 12px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #6c757d;
            color: white;
        }

        .action-btn.edit {
            background: #007bff;
        }

        .action-btn.delete {
            background: #dc3545;
        }

        .action-btn:hover {
            opacity: 0.8;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .nav-menu {
                position: static;
                transform: none;
                justify-content: center;
                margin-top: 20px;
                margin-bottom: 20px;
            }

            .nav-container {
                flex-direction: column;
                height: auto;
                padding: 20px 0;
            }

            .logo-icon,
            .brand-name {
                position: static;
            }

            .writing-center {
                margin: 20px;
            }

            .page-header,
            .creation-type-selector,
            .creation-form,
            .bottom-nav {
                padding: 20px;
            }

            .type-tabs {
                flex-direction: column;
            }

            .type-tab {
                text-align: center;
            }

            .action-buttons {
                flex-direction: column;
            }

            .bottom-nav {
                flex-direction: column;
                text-align: center;
            }
        }

        @font-face {
            font-family: 'ZiHun86';
            src: url('../fonts/å­—é­‚86å·-æ¨ä»»ä¸œæ¥·ä¹¦.woff2') format('woff2'),
                 url('../fonts/å­—é­‚86å·-æ¨ä»»ä¸œæ¥·ä¹¦.woff') format('woff');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="1.html" class="logo">
                <span class="logo-icon">
                    <img src="images/logo.png" alt="æ˜‡å“¥æ•°å­¦ logo">
                </span>
                <span class="brand-name">æ˜‡ä¹‹å®¶</span>
            </a>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="1.html#news" class="nav-link">æœ€æ–°åŠ¨æ€</a>
                </li>
                <li class="nav-item">
                    <a href="1.html#hobbys" class="nav-link active">æˆ‘çš„çˆ±å¥½</a>
                </li>
                <li class="nav-item">
                    <a href="1.html#events" class="nav-link">æ—¥è®°å¿ƒå¾—</a>
                </li>
            </ul>
        </div>
    </nav>
    
    <!-- ä¸»è¦å†…å®¹ -->
    <div class="container">
        <div class="writing-center">
            <!-- é¡µé¢æ ‡é¢˜ -->
            <div class="page-header">
                <h1 class="page-title">æ–‡å­¦åˆ›ä½œä¸­å¿ƒ</h1>
                <p class="page-subtitle">åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥åˆ›ä½œã€ç¼–è¾‘å’Œç®¡ç†ä½ çš„æ–‡å­¦ä½œå“</p>
            </div>
            
            <!-- åˆ›ä½œç±»å‹é€‰æ‹©å™¨ -->
            <div class="creation-type-selector">
                <h2 class="selector-title">é€‰æ‹©åˆ›ä½œç±»å‹</h2>
                <div class="type-tabs">
                    <div class="type-tab active" data-type="prose">âœï¸ æ•£æ–‡åˆ›ä½œ</div>
                    <div class="type-tab" data-type="novel">ğŸ“š å°è¯´åˆ›ä½œ</div>
                    <div class="type-tab" data-type="poetry">ğŸ“œ è¯—æ­Œåˆ›ä½œ</div>
                </div>
            </div>
            
            <!-- åˆ›ä½œè¡¨å• -->
            <div class="creation-form">
                <!-- æˆåŠŸä¿å­˜æç¤º -->
                <div class="success-message" id="successMessage">
                    <strong>ä¿å­˜æˆåŠŸï¼</strong> æ‚¨çš„ä½œå“å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ä¸­ã€‚
                </div>
                
                <!-- æ•£æ–‡åˆ›ä½œè¡¨å• -->
                <div class="type-form active" id="proseForm">
                    <div class="form-group">
                        <label for="proseTitle" class="form-label">æ•£æ–‡æ ‡é¢˜</label>
                        <input type="text" id="proseTitle" class="form-input" placeholder="è¯·è¾“å…¥æ•£æ–‡æ ‡é¢˜">
                        <div class="form-hint">ä¸€ä¸ªå¼•äººå…¥èƒœçš„æ ‡é¢˜å¯ä»¥æ›´å¥½åœ°å¸å¼•è¯»è€…</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="proseCategory" class="form-label">åˆ†ç±»</label>
                        <input type="text" id="proseCategory" class="form-input" placeholder="ä¾‹å¦‚ï¼šéšç¬”ã€æ¸¸è®°ã€æ„Ÿæ‚Ÿç­‰">
                    </div>
                    
                    <div class="form-group">
                        <label for="proseContent" class="form-label">æ•£æ–‡å†…å®¹</label>
                        <textarea id="proseContent" class="form-textarea" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„æ•£æ–‡..."></textarea>
                        <div class="form-hint">æ•£æ–‡æ³¨é‡æƒ…æ„Ÿè¡¨è¾¾å’ŒçœŸå®ä½“éªŒï¼Œå¯ä»¥è‡ªç”±å‘æŒ¥</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="proseTags" class="form-label">æ ‡ç­¾</label>
                        <input type="text" id="proseTags" class="form-input" placeholder="å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ï¼šç”Ÿæ´»,æ„Ÿæ‚Ÿ,æ•™è‚²">
                    </div>
                </div>
                
                <!-- å°è¯´åˆ›ä½œè¡¨å• -->
                <div class="type-form" id="novelForm">
                    <div class="form-group">
                        <label for="novelTitle" class="form-label">å°è¯´æ ‡é¢˜</label>
                        <input type="text" id="novelTitle" class="form-input" placeholder="è¯·è¾“å…¥å°è¯´æ ‡é¢˜">
                    </div>
                    
                    <div class="form-group">
                        <label for="novelChapter" class="form-label">ç« èŠ‚æ ‡é¢˜</label>
                        <input type="text" id="novelChapter" class="form-input" placeholder="ä¾‹å¦‚ï¼šç¬¬ä¸€ç« ã€ç¬¬äºŒèŠ‚ç­‰">
                    </div>
                    
                    <div class="form-group">
                        <label for="novelGenre" class="form-label">å°è¯´ç±»å‹</label>
                        <input type="text" id="novelGenre" class="form-input" placeholder="ä¾‹å¦‚ï¼šæ•™è‚²å°è¯´ã€çŸ­ç¯‡å°è¯´ã€æˆé•¿æ•…äº‹ç­‰">
                    </div>
                    
                    <div class="form-group">
                        <label for="novelContent" class="form-label">å°è¯´å†…å®¹</label>
                        <textarea id="novelContent" class="form-textarea" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„å°è¯´ç« èŠ‚..."></textarea>
                        <div class="form-hint">å°è¯´åˆ›ä½œæ³¨é‡æƒ…èŠ‚å‘å±•ã€äººç‰©å¡‘é€ å’Œç¯å¢ƒæå†™</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="novelCharacters" class="form-label">ä¸»è¦äººç‰©</label>
                        <input type="text" id="novelCharacters" class="form-input" placeholder="ä¾‹å¦‚ï¼šææ˜ã€ç‹è€å¸ˆã€å°åç­‰">
                    </div>
                    
                    <div class="form-group">
                        <label for="novelTags" class="form-label">æ ‡ç­¾</label>
                        <input type="text" id="novelTags" class="form-input" placeholder="å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ï¼šæ ¡å›­,æˆé•¿,æ•™è‚²">
                    </div>
                </div>
                
                <!-- è¯—æ­Œåˆ›ä½œè¡¨å• -->
                <div class="type-form" id="poetryForm">
                    <div class="form-group">
                        <label for="poetryTitle" class="form-label">è¯—æ­Œæ ‡é¢˜</label>
                        <input type="text" id="poetryTitle" class="form-input" placeholder="è¯·è¾“å…¥è¯—æ­Œæ ‡é¢˜">
                    </div>
                    
                    <div class="form-group">
                        <label for="poetryType" class="form-label">è¯—æ­Œç±»å‹</label>
                        <input type="text" id="poetryType" class="form-input" placeholder="ä¾‹å¦‚ï¼šç°ä»£è¯—ã€å¤ä½“è¯—ã€æ•™è‚²è¯—ç­‰">
                    </div>
                    
                    <div class="form-group">
                        <label for="poetryContent" class="form-label">è¯—æ­Œå†…å®¹</label>
                        <textarea id="poetryContent" class="form-textarea" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„è¯—æ­Œ..."></textarea>
                        <div class="form-hint">è¯—æ­Œåˆ›ä½œæ³¨é‡æ„è±¡ã€éŸµå¾‹å’Œæƒ…æ„Ÿçš„å‡ç»ƒè¡¨è¾¾</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="poetryTheme" class="form-label">ä¸»é¢˜</label>
                        <input type="text" id="poetryTheme" class="form-input" placeholder="ä¾‹å¦‚ï¼šæ•™è‚²ã€è‡ªç„¶ã€ç”Ÿæ´»ã€ç†æƒ³ç­‰">
                    </div>
                    
                    <div class="form-group">
                        <label for="poetryTags" class="form-label">æ ‡ç­¾</label>
                        <input type="text" id="poetryTags" class="form-input" placeholder="å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ï¼šæŠ’æƒ…,å“²ç†,æ•™è‚²">
                    </div>
                </div>
                
                <!-- æ“ä½œæŒ‰é’® -->
                <div class="action-buttons">
                    <button class="btn btn-primary" id="saveButton">
                        <span class="btn-icon">ğŸ’¾</span> ä¿å­˜ä½œå“
                    </button>
                    <button class="btn btn-secondary" id="previewButton">
                        <span class="btn-icon">ğŸ‘ï¸</span> é¢„è§ˆä½œå“
                    </button>
                    <button class="btn btn-secondary" id="clearButton">
                        <span class="btn-icon">ğŸ—‘ï¸</span> æ¸…ç©ºå†…å®¹
                    </button>
                </div>
                
                <!-- é¢„è§ˆåŒºåŸŸ -->
                <div class="preview-section">
                    <h3 class="preview-title">ä½œå“é¢„è§ˆ</h3>
                    <div class="preview-container empty" id="previewContainer">
                        ç‚¹å‡»ã€Œé¢„è§ˆä½œå“ã€æŒ‰é’®æŸ¥çœ‹é¢„è§ˆæ•ˆæœ
                    </div>
                </div>
                
                <!-- å·²ä¿å­˜ä½œå“åˆ—è¡¨ -->
                <div class="works-list">
                    <h3 class="works-title">å·²ä¿å­˜ä½œå“</h3>
                    <div id="worksList">
                        <!-- ä½œå“åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        <div class="work-item">
                            <div class="work-info">
                                <div class="work-name">æš‚æœªä¿å­˜ä»»ä½•ä½œå“</div>
                                <div class="work-meta">å¼€å§‹åˆ›ä½œå¹¶ä¿å­˜ä½ çš„ç¬¬ä¸€ä¸ªä½œå“</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- åº•éƒ¨å¯¼èˆª -->
            <div class="bottom-nav">
                <div class="nav-info">
                    ğŸ’¡ æç¤ºï¼šæ‰€æœ‰ä½œå“å°†ä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œåˆ·æ–°é¡µé¢ä¸ä¼šä¸¢å¤±
                </div>
                <a href="hobby-4.html" class="btn btn-secondary">
                    <span class="btn-icon">ğŸ </span> è¿”å›æ–‡å­¦åˆ›ä½œä¸»é¡µ
                </a>
            </div>
        </div>
    </div>

    <script>
        // DOMå…ƒç´ å¼•ç”¨
        const typeTabs = document.querySelectorAll('.type-tab');
        const typeForms = document.querySelectorAll('.type-form');
        const saveButton = document.getElementById('saveButton');
        const previewButton = document.getElementById('previewButton');
        const clearButton = document.getElementById('clearButton');
        const successMessage = document.getElementById('successMessage');
        const previewContainer = document.getElementById('previewContainer');
        const worksList = document.getElementById('worksList');
        
        // å½“å‰æ¿€æ´»çš„åˆ›ä½œç±»å‹
        let activeType = 'prose';
        
        // ç¤ºä¾‹ä½œå“æ•°æ®
        let worksData = [];
        
        // åˆå§‹åŒ–ï¼šä»æœ¬åœ°å­˜å‚¨åŠ è½½ä½œå“æ•°æ®
        function init() {
            const savedWorks = localStorage.getItem('literaryWorks');
            if (savedWorks) {
                worksData = JSON.parse(savedWorks);
                renderWorksList();
            }
        }
        
        // åˆ‡æ¢åˆ›ä½œç±»å‹
        function switchType(type) {
            activeType = type;
            
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            typeTabs.forEach(tab => {
                if (tab.dataset.type === type) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // æ›´æ–°è¡¨å•æ˜¾ç¤º
            typeForms.forEach(form => {
                if (form.id === `${type}Form`) {
                    form.classList.add('active');
                } else {
                    form.classList.remove('active');
                }
            });
        }
        
        // ä¿å­˜ä½œå“
        function saveWork() {
            let title, content, category, tags, otherFields = {};
            
            switch(activeType) {
                case 'prose':
                    title = document.getElementById('proseTitle').value.trim();
                    content = document.getElementById('proseContent').value.trim();
                    category = document.getElementById('proseCategory').value.trim();
                    tags = document.getElementById('proseTags').value.trim();
                    
                    if (!title || !content) {
                        alert('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹ï¼');
                        return;
                    }
                    
                    otherFields = {
                        category: category,
                        tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag)
                    };
                    break;
                    
                case 'novel':
                    title = document.getElementById('novelTitle').value.trim();
                    content = document.getElementById('novelContent').value.trim();
                    category = document.getElementById('novelGenre').value.trim();
                    tags = document.getElementById('novelTags').value.trim();
                    
                    if (!title || !content) {
                        alert('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹ï¼');
                        return;
                    }
                    
                    otherFields = {
                        chapter: document.getElementById('novelChapter').value.trim(),
                        genre: category,
                        characters: document.getElementById('novelCharacters').value.trim(),
                        tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag)
                    };
                    break;
                    
                case 'poetry':
                    title = document.getElementById('poetryTitle').value.trim();
                    content = document.getElementById('poetryContent').value.trim();
                    category = document.getElementById('poetryType').value.trim();
                    tags = document.getElementById('poetryTags').value.trim();
                    
                    if (!title || !content) {
                        alert('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹ï¼');
                        return;
                    }
                    
                    otherFields = {
                        poetryType: category,
                        theme: document.getElementById('poetryTheme').value.trim(),
                        tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag)
                    };
                    break;
            }
            
            // åˆ›å»ºä½œå“å¯¹è±¡
            const work = {
                id: Date.now(), // ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ID
                type: activeType,
                typeName: getTypeName(activeType),
                title: title,
                content: content,
                createTime: new Date().toLocaleString(),
                updateTime: new Date().toLocaleString(),
                ...otherFields
            };
            
            // æ·»åŠ åˆ°ä½œå“æ•°æ®ä¸­
            worksData.push(work);
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveToLocalStorage();
            
            // æ›´æ–°ä½œå“åˆ—è¡¨
            renderWorksList();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
            
            // æ¸…ç©ºè¡¨å•
            clearForm();
        }
        
        // é¢„è§ˆä½œå“
        function previewWork() {
            let title, content;
            
            switch(activeType) {
                case 'prose':
                    title = document.getElementById('proseTitle').value.trim();
                    content = document.getElementById('proseContent').value.trim();
                    break;
                case 'novel':
                    title = document.getElementById('novelTitle').value.trim();
                    const chapter = document.getElementById('novelChapter').value.trim();
                    content = document.getElementById('novelContent').value.trim();
                    title = chapter ? `${title} - ${chapter}` : title;
                    break;
                case 'poetry':
                    title = document.getElementById('poetryTitle').value.trim();
                    content = document.getElementById('poetryContent').value.trim();
                    break;
            }
            
            if (!title && !content) {
                previewContainer.innerHTML = 'æš‚æ— å¯é¢„è§ˆå†…å®¹ï¼Œè¯·å…ˆè¾“å…¥ä½œå“æ ‡é¢˜å’Œå†…å®¹';
                previewContainer.classList.add('empty');
                return;
            }
            
            previewContainer.classList.remove('empty');
            
            // æ ¼å¼åŒ–å†…å®¹æ˜¾ç¤º
            let formattedContent = '';
            if (activeType === 'poetry') {
                // è¯—æ­Œæ ¼å¼åŒ–ï¼šä¿ç•™æ¢è¡Œ
                formattedContent = content.split('\n')
                    .map(line => line.trim())
                    .filter(line => line)
                    .map(line => `<p style="text-align: center; margin-bottom: 10px; font-style: italic;">${line}</p>`)
                    .join('');
            } else {
                // æ•£æ–‡å’Œå°è¯´æ ¼å¼åŒ–ï¼šæ®µè½å¤„ç†
                formattedContent = content.split('\n')
                    .map(paragraph => paragraph.trim())
                    .filter(paragraph => paragraph)
                    .map(paragraph => `<p style="margin-bottom: 15px; text-indent: 2em;">${paragraph}</p>`)
                    .join('');
            }
            
            previewContainer.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--text-color); margin-bottom: 10px; font-size: 22px;">${title || 'æœªå‘½åä½œå“'}</h3>
                    <div style="color: var(--text-light); font-size: 14px; margin-bottom: 20px;">
                        ç±»å‹ï¼š${getTypeName(activeType)} | é¢„è§ˆæ—¶é—´ï¼š${new Date().toLocaleString()}
                    </div>
                </div>
                <div style="line-height: 1.8; color: var(--text-color);">
                    ${formattedContent || '<p style="color: var(--text-light); font-style: italic;">å†…å®¹ä¸ºç©º</p>'}
                </div>
            `;
        }
        
        // æ¸…ç©ºè¡¨å•
        function clearForm() {
            const currentForm = document.getElementById(`${activeType}Form`);
            const inputs = currentForm.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.value = '';
            });
            
            // æ¸…ç©ºé¢„è§ˆ
            previewContainer.innerHTML = 'ç‚¹å‡»ã€Œé¢„è§ˆä½œå“ã€æŒ‰é’®æŸ¥çœ‹é¢„è§ˆæ•ˆæœ';
            previewContainer.classList.add('empty');
        }
        
        // æ¸²æŸ“ä½œå“åˆ—è¡¨
        function renderWorksList() {
            if (worksData.length === 0) {
                worksList.innerHTML = `
                    <div class="work-item">
                        <div class="work-info">
                            <div class="work-name">æš‚æœªä¿å­˜ä»»ä½•ä½œå“</div>
                            <div class="work-meta">å¼€å§‹åˆ›ä½œå¹¶ä¿å­˜ä½ çš„ç¬¬ä¸€ä¸ªä½œå“</div>
                        </div>
                    </div>
                `;
                return;
            }
            
            // æŒ‰æ›´æ–°æ—¶é—´å€’åºæ’åº
            const sortedWorks = [...worksData].sort((a, b) => {
                return new Date(b.updateTime) - new Date(a.updateTime);
            });
            
            worksList.innerHTML = sortedWorks.map(work => `
                <div class="work-item" data-id="${work.id}">
                    <div class="work-info">
                        <div class="work-name">${work.title}</div>
                        <div class="work-meta">
                            ${work.typeName} | æ›´æ–°æ—¶é—´ï¼š${work.updateTime}
                            ${work.tags && work.tags.length > 0 ? 
                                `<br>æ ‡ç­¾ï¼š${work.tags.join('ã€')}` : ''}
                        </div>
                    </div>
                    <div class="work-actions">
                        <button class="action-btn edit" onclick="editWork(${work.id})"><span>ğŸ“</span></button>
                        <button class="action-btn delete" onclick="deleteWork(${work.id})"><span>ğŸ—‘ï¸</span></button>
                    </div>
                </div>
            `).join('');
        }
        
        // ç¼–è¾‘ä½œå“
        function editWork(id) {
            const work = worksData.find(w => w.id === id);
            if (!work) return;
            
            // åˆ‡æ¢åˆ°å¯¹åº”ç±»å‹
            switchType(work.type);
            
            // å¡«å……è¡¨å•æ•°æ®
            switch(work.type) {
                case 'prose':
                    document.getElementById('proseTitle').value = work.title;
                    document.getElementById('proseContent').value = work.content;
                    document.getElementById('proseCategory').value = work.category || '';
                    document.getElementById('proseTags').value = work.tags ? work.tags.join(', ') : '';
                    break;
                    
                case 'novel':
                    document.getElementById('novelTitle').value = work.title;
                    document.getElementById('novelChapter').value = work.chapter || '';
                    document.getElementById('novelContent').value = work.content;
                    document.getElementById('novelGenre').value = work.genre || '';
                    document.getElementById('novelCharacters').value = work.characters || '';
                    document.getElementById('novelTags').value = work.tags ? work.tags.join(', ') : '';
                    break;
                    
                case 'poetry':
                    document.getElementById('poetryTitle').value = work.title;
                    document.getElementById('poetryContent').value = work.content;
                    document.getElementById('poetryType').value = work.poetryType || '';
                    document.getElementById('poetryTheme').value = work.theme || '';
                    document.getElementById('poetryTags').value = work.tags ? work.tags.join(', ') : '';
                    break;
            }
            
            // æ»šåŠ¨åˆ°è¡¨å•é¡¶éƒ¨
            document.querySelector('.creation-form').scrollIntoView({ behavior: 'smooth' });
            
            // åˆ é™¤åŸä½œå“ï¼ˆç¨åå°†ä»¥æ›´æ–°å½¢å¼é‡æ–°ä¿å­˜ï¼‰
            deleteWork(id, false);
        }
        
        // åˆ é™¤ä½œå“
        function deleteWork(id, showAlert = true) {
            if (showAlert && !confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä½œå“å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                return;
            }
            
            worksData = worksData.filter(work => work.id !== id);
            saveToLocalStorage();
            renderWorksList();
        }
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveToLocalStorage() {
            localStorage.setItem('literaryWorks', JSON.stringify(worksData));
            
            // è§¦å‘å¤šç§æ–¹å¼çš„é€šçŸ¥ï¼Œç¡®ä¿hobby-4.htmlèƒ½æ¥æ”¶åˆ°æ›´æ–°
            // 1. é€šçŸ¥æ‰“å¼€çš„çª—å£
            if (window.opener) {
                window.opener.postMessage({type: 'worksUpdated'}, '*');
            }
            
            // 2. é€šçŸ¥çˆ¶çª—å£ï¼ˆå¦‚æœåœ¨iframeä¸­ï¼‰
            if (window.parent && window.parent !== window) {
                window.parent.postMessage({type: 'worksUpdated'}, '*');
            }
            
            // 3. ä½¿ç”¨BroadcastChannel APIï¼ˆç°ä»£æµè§ˆå™¨æ”¯æŒï¼‰
            try {
                const channel = new BroadcastChannel('literaryWorksChannel');
                channel.postMessage({type: 'worksUpdated'});
                channel.close();
            } catch (e) {
                console.log('BroadcastChannel not supported');
            }
            
            // 4. è®°å½•æœ€åæ›´æ–°æ—¶é—´ï¼Œæ–¹ä¾¿å…¶ä»–é¡µé¢è½®è¯¢æ£€æµ‹
            localStorage.setItem('lastWorksUpdate', Date.now().toString());
        }
        
        // è·å–ç±»å‹åç§°
        function getTypeName(type) {
            const typeNames = {
                'prose': 'æ•£æ–‡',
                'novel': 'å°è¯´',
                'poetry': 'è¯—æ­Œ'
            };
            return typeNames[type] || type;
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        typeTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                switchType(tab.dataset.type);
            });
        });
        
        saveButton.addEventListener('click', saveWork);
        previewButton.addEventListener('click', previewWork);
        clearButton.addEventListener('click', clearForm);
        
        // æš´éœ²å‡½æ•°åˆ°å…¨å±€ï¼Œä¾›HTMLä¸­ä½¿ç”¨
        window.editWork = editWork;
        window.deleteWork = deleteWork;
        
        // åˆå§‹åŒ–é¡µé¢
        init();
        
        // æ·»åŠ æ¶ˆæ¯ç›‘å¬å™¨ï¼Œæ¥æ”¶æ¥è‡ªå…¶ä»–é¡µé¢çš„è¯·æ±‚
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'getWorks') {
                if (event.source) {
                    event.source.postMessage({type: 'worksData', data: worksData}, event.origin);
                }
            }
            
            // æ¥æ”¶åˆ·æ–°ä½œå“åˆ—è¡¨çš„è¯·æ±‚
            if (event.data && event.data.type === 'refreshWorks') {
                init(); // é‡æ–°åŠ è½½ä½œå“æ•°æ®
            }
        });
        
        // å°è¯•ä½¿ç”¨BroadcastChannelç›‘å¬ä½œå“æ›´æ–°
        try {
            const channel = new BroadcastChannel('literaryWorksChannel');
            channel.addEventListener('message', function(event) {
                if (event.data && event.data.type === 'worksUpdated') {
                    init(); // å½“æœ‰å…¶ä»–é¡µé¢æ›´æ–°ä½œå“æ—¶ï¼Œé‡æ–°åŠ è½½
                }
            });
            
            // åœ¨é¡µé¢å¸è½½æ—¶å…³é—­é€šé“
            window.addEventListener('beforeunload', function() {
                channel.close();
            });
        } catch (e) {
            console.log('BroadcastChannel not supported');
        }
        
        // æ·»åŠ ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰‹åŠ¨è§¦å‘ä½œå“æ›´æ–°é€šçŸ¥ï¼ˆæ–¹ä¾¿è°ƒè¯•å’Œæµ‹è¯•ï¼‰
        window.notifyWorksUpdated = function() {
            saveToLocalStorage();
        };
        
        // è‡ªåŠ¨ä¿å­˜åŠŸèƒ½ï¼ˆæ¯30ç§’è‡ªåŠ¨é¢„è§ˆï¼Œæ¨¡æ‹Ÿè‡ªåŠ¨ä¿å­˜æç¤ºï¼‰
        setInterval(() => {
            // æ£€æŸ¥å½“å‰è¡¨å•æ˜¯å¦æœ‰å†…å®¹
            let hasContent = false;
            const currentForm = document.getElementById(`${activeType}Form`);
            const inputs = currentForm.querySelectorAll('input, textarea');
            
            for (let i = 0; i < inputs.length; i++) {
                if (inputs[i].value.trim()) {
                    hasContent = true;
                    break;
                }
            }
            
            if (hasContent) {
                console.log('æ­£åœ¨è‡ªåŠ¨ä¿å­˜è‰ç¨¿...');
            }
        }, 30000);
    </script>
</body>
    <script>
        // ç™»å½•çŠ¶æ€æ£€æŸ¥
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
            const userType = localStorage.getItem('userType');
            
            // å¦‚æœæœªç™»å½•ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µ
            if (!userType) {
                window.location.href = 'login.html';
                return;
            }
            
            // åˆ›å»ºé€€å‡ºç™»å½•æŒ‰é’®
            const logoutBtn = document.createElement('button');
            logoutBtn.className = 'logout-btn';
            logoutBtn.textContent = 'é€€å‡ºç™»å½•';
            document.body.appendChild(logoutBtn);
            
            // é€€å‡ºç™»å½•äº‹ä»¶
            logoutBtn.addEventListener('click', function() {
                localStorage.removeItem('userType');
                localStorage.removeItem('isLoggedIn');
                window.location.href = 'login.html';
            });
            
            // æ¸¸å®¢æ¨¡å¼æƒé™æ§åˆ¶
            if (userType === 'visitor') {
                // éšè—ç¼–è¾‘ã€ä¿å­˜å’Œåˆ é™¤æŒ‰é’®
                const editButtons = document.querySelectorAll('.edit-btn, .save-btn, .delete-btn');
                editButtons.forEach(btn => {
                    btn.style.display = 'none';
                });
                
                // éšè—æ‰€æœ‰è¡¨å•
                const forms = document.querySelectorAll('form');
                forms.forEach(form => {
                    form.style.display = 'none';
                });
            }
        });
    </script>
</html>